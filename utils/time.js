function fomater(a) { return a < 10 ? "0" + a : a } function minuteFor(a, c) { for (var b = a; b < 60; b++) { if (JSON.stringify(b).indexOf("0") != -1) { c.push(fomater(parseInt(b))) } } } function allMinute(b) { var a = 0, c = []; minuteFor(a, c); b.setData({ startMinute: c, endMinute: c, beginM: c[0], endM: c[0], bm: [0], em: [0] }) } function sMinuteFor(b) { var a = 0, c = []; minuteFor(a, c); b.setData({ startMinute: c, beginM: c[0], bm: [0] }) } function sToSixty(b) { var c = new Date(); var a = c.getMinutes(); var d = []; minuteFor(a, d); b.setData({ startMinute: d, beginM: d[0], bm: [0] }) } function eDefaultMinute(b) { var a = 0, c = []; minuteFor(a, c); b.setData({ endMinute: c, endM: c[3], em: [3] }) } function eAddToSixty(b) { var c = new Date(); var a = c.getMinutes(); var d = []; minuteFor(a, d); b.setData({ endMinute: d, endM: d[3], em: [3] }) } function eMinuteFor(c) { var d = new Date(); var b = parseInt(d.getMinutes()) + 30; var a = b - 60; var f = [], e; minuteFor(0, f); if (a == 0) { e = 0 } else { if (a <= 10) { e = 1 } else { if (a <= 20) { e = 2 } } } c.setData({ endMinute: f, endM: f[e], em: [e] }) } function minuteNow(b) { var c = new Date(); var a = c.getMinutes(); var d = []; minuteFor(a, d); b.setData({ startMinute: d, endMinute: d, beginM: d[0], endM: d[0], bm: [0], em: [0] }) } function hourFor(c, b) { for (var a = c; a < 24; a++) { b.push(fomater(parseInt(a))) } } function allHour(b) { var c = 0, a = []; hourFor(c, a); b.setData({ startHours: a, endHour: a, endH: a[0], beginH: a[0], bh: [0], eh: [0] }) } function sToTF(b) { var d = new Date(); var c = d.getHours(); var a = []; hourFor(c, a); b.setData({ startHours: a, endHour: a, endH: a[0], beginH: a[0], bh: [0], eh: [0] }) } function startHourTo(b) { var d = new Date(); var c = d.getHours(); var a = []; hourFor(c, a); b.setData({ startHours: a, beginH: a[0], bh: [0] }) } function endHourTo(a, c) { var e = new Date(); var d, b = []; if (60 > a + 10 > 50) { d = e.getHours() + 1 } else { d = e.getHours() } hourFor(d, b); c.setData({ endHour: b, endH: b[1], eh: [1] }) } function allAdd(a, c) { var e = new Date(); var d = parseInt(e.getHours()) + 1; var b = []; hourFor(d, b); c.setData({ startHours: b, endHour: b, beginH: b[0], endH: b[0], bh: [0], eh: [0] }) } function nowDate(b) { var d = new Date(); var a = d.getMinutes(); var c = d.getHours(); if (c == 23) { sToTF(b); sToSixty(b); minuteNow(b) } else { if (a > 50) { allAdd(c, b); sMinuteFor(b); eDefaultMinute(b) } else { if ((a + 30) < 50) { sToTF(b); sToSixty(b); eAddToSixty(b) } else { endHourTo(a, b); startHourTo(b); eMinuteFor(b); sToSixty(b) } } } } function touchHours(c, d, b) { var a = []; hourFor(c, a); b.setData({ endHour: a, beginH: c, endH: c, bh: [d], eh: [0], em: [0], bm: [0] }) } function addOne(e, c) { var d = new Date(); var a = d.getMinutes(); var b = []; var f = e + 1; if (a >= 50) { hourFor(f, b) } else { hourFor(e, b) } c.setData({ startHours: b, endHour: b, beginH: b[0], endH: b[0] }) } function touchMinute(d, c, a) { var b = []; minuteFor(d, b); a.setData({ endMinute: b, endM: d, beginM: d, bm: [c], em: [0] }) } function endSixty(a) { var b = []; minuteFor(0, b); a.setData({ endMinute: b, endM: b[0], em: [0] }) } function selDay(b, a) { var c = b.detail.value[0]; if (c != 0) { allHour(a); allMinute(a) } else { nowDate(a) } a.setData({ dayStatu: c, dayNow: a.data.days[c] }) } function startHour(f, b) { var c = b.data.startHours[0]; var d = f.detail.value[0]; var g = b.data.startHours[d]; var a = []; if (b.data.dayStatu != 0) { allMinute(b); touchHours(g, d, b) } else { if (g != c) { allMinute(b); touchHours(g, d, b) } else { minuteNow(b); addOne(g, b); b.setData({ bh: [d], eh: [0], em: [0], bm: [0] }) } } } function startMinte(f, a) { var d = f.detail.value[0]; var c = a.data.startMinute[d]; var b = []; if (a.data.dayStatu != 0) { if (a.data.beginH == a.data.endH) { touchMinute(c, d, a) } else { a.setData({ beginM: c, bm: [d] }) } } else { if (a.data.beginH == a.data.endH) { touchMinute(c, d, a) } else { a.setData({ beginM: c, bm: [d] }) } } } function endHour(f, b) { var c = b.data.endHour[0]; var d = f.detail.value[0]; var g = b.data.endHour[d]; var a = []; if (b.data.dayStatu == 0) { if (g != c) { endSixty(b); b.setData({ endH: g, eh: [d] }) } else { b.setData({ endMinute: b.data.startMinute, endM: b.data.startMinute[0], endH: g, eh: [d], em: [0], bm: [0], beginM: b.data.startMinute[0] }) } } else { if (b.data.beginH != g) { endSixty(b); b.setData({ endH: g, eh: [d] }) } else { allMinute(b); b.setData({ endH: g, eh: [d], bm: [0], em: [0] }) } } } module.exports = { nowDate: nowDate, startHour: startHour, startMinte: startMinte, endHour: endHour, selDay: selDay };
